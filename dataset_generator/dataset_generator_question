import csv
import time
import google.generativeai as genai

# 🔐 1. Set up Gemini API
genai.configure(api_key="AIzaSyBX_duyO--fjijD-41n-AuiUB3feJLcPW0")  # Replace with your actual key

# 🧠 2. Gemini model
model = genai.GenerativeModel("gemini-1.5-pro-latest")

# 📝 3. Prompt template
prompt = """
Generate 100 general tarot questions related to self-reflection, awareness, personal growth, or life guidance.
Avoid love, health, and career questions. Keep questions short, clear, and open-ended.
Only list the questions. No extra text.
"""

# 📁 4. Output setup
total_required = 5000
questions_generated = 0
output_path = "tarot_general_questions_5k.csv"
question_set = set()

# 💾 5. Write to CSV
with open(output_path, mode='w', newline='', encoding='utf-8') as file:
    writer = csv.writer(file)
    writer.writerow(["question"])

    while questions_generated < total_required:
        try:
            # Generate questions
            response = model.generate_content(prompt)
            lines = [line.strip("•-1234567890. ").strip() for line in response.text.strip().split("\n") if line.strip()]

            # Save new questions only
            for question in lines:
                if question not in question_set and questions_generated < total_required:
                    writer.writerow([question])
                    question_set.add(question)
                    questions_generated += 1

            time.sleep(0.5)  # light delay to reduce risk of rate limiting

        except Exception:
            time.sleep(2)  # retry on failure

print("✅ tarot_general_questions_5k.csv created successfully.")
